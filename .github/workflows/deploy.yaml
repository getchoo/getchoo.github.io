name: deploy to gh pages

on:
	push:
		branches: [main]
	workflow_dispatch:

permissions:
	contents: read
	pages: write
	id-token: write

jobs:
	build:
		runs-on: ubuntu-latest

		steps:
			- uses: actions/checkout@v3

			- name: setup deno
				uses: denoland/setup-deno@v1
				with:
					deno-version: v1.31.3

			- name: build site
				run: deno task build

			- name: setup pages
				uses: actions/configure-pages@v3

			- name: upload artifact
				uses: actions/upload-pages-artifact@v1
				with:
					path: '_site'

			- name: deploy
				id: deployment
				uses: actions/deploy-pages@v1
